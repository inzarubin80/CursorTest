# Описание сервиса MCP 1C Standards

## Назначение

**mcp-1c-standards** — MCP-сервер (Model Context Protocol), который предоставляет ассистенту и IDE доступ к текстам и правилам стандартов разработки 1С (v8std, EDT) без выхода в интернет. Данные читаются из локального каталога проекта или из контента, встроенного в бинарник.

Использование:

- быстрая справка по документирующим комментариям (стандарт 453, EDT);
- поиск раздела стандарта по номеру или ключевому слову;
- получение полного текста стандарта по ID (если он есть в каталоге контента, например `std-<id>.md`);
- проверка текста комментария на соответствие формату «Параметры:», «Имя - Тип - Описание»;
- подсказки по диагностикам BSL Language Server (MissingSpace, FunctionOutParameter, LineLength и др.).

## Возможности (инструменты)

Сервис регистрирует три инструмента (tools), которые можно вызывать из MCP-клиента (Cursor, Claude Code и т.п.):

| Инструмент | Назначение |
|------------|------------|
| **standards_doc_comment** | Возвращает правила и пример оформления документирующего комментария к процедуре/функции BSL (v8std 453, EDT). Опциональный параметр `topic`: сужение по теме (параметры, пример, структура). |
| **standards_lookup** | Поиск по разделам стандартов. Параметр `topic`: ID раздела (453, 641, 647, 783, … или doc-comment, naming, formatting) или ключевое слово. Если у раздела указан `localFile`, в ответ подставляется полный текст стандарта из файла. Для кодов диагностик BSL LS (например MissingSpace) возвращается подсказка по исправлению. |
| **standards_check_comment** | Проверяет переданный текст документирующего комментария: есть ли блок «Параметры:», строки параметров в формате «Имя - Тип - Описание», при необходимости «Возвращаемое значение:». Возвращает замечания и рекомендации. |

## Контент: откуда читается

Сервис **не обращается к интернету**. Источники данных (по приоритету):

1. **Переменная окружения `MCP_1C_STANDARDS_CONTENT`** — путь к каталогу, в котором лежат `doc-comment.md`, `lookup.json` и при необходимости `std-<id>.md`.
2. **Каталог `content/` рядом с исполняемым файлом** — например при распространении бинарника.
3. **Каталог `content/` в текущей рабочей директории**.
4. **Каталог `internal/tools/content/` в текущей рабочей директории** — при запуске из корня репозитория.
5. **Встроенный контент (embed)** — если ни один из каталогов не найден, используется контент из `internal/tools/content/`, вшитый в бинарник при сборке.

Таким образом, можно раздавать один бинарник — он уже содержит базовый набор стандартов; при необходимости контент переопределяется каталогом или переменной окружения.

## Структура контента

- **doc-comment.md** — свод правил и примеров документирующего комментария (по стандарту 453 и EDT).
- **lookup.json** — список разделов (sections) и диагностик (diagnostics). У каждого раздела может быть:
  - `id`, `title`, `summary`, `url` (ссылка на ИТС);
  - `localFile` — имя файла в каталоге контента (например `std-453.md`); при запросе по этому разделу в ответ добавляется полный текст из файла.
- **std-&lt;id&gt;.md** — полные тексты стандартов в формате Markdown (скачаны с v8std.ru или добавлены вручную).

## Технические требования

- Go 1.23+ для сборки.
- Режим работы: **stdio** — обмен с клиентом через stdin/stdout (типичный сценарий для MCP в Cursor/IDE).

Подробности сборки и подключения в Cursor см. в [README проекта](../README.md).
