# Архитектура

MCP 1C Structure состоит из MCP-сервера и набора ручек загрузки снимка; данные хранятся только в PostgreSQL.

## Компоненты

- **mcp-1c-structure** — MCP-сервер (stdio). Подключается к Postgres при старте, регистрирует инструменты. Все чтения и запись при импорте идут через один Store (Postgres).
- **indexer** — утилита загрузки снимка в БД: режим CLI (чтение из каталога) или HTTP-сервер (приём JSON по POST /import).

## Поток данных

Данные в БД появляются только после вызова одной из трёх ручек: MCP-инструмент structure_import_snapshot, CLI indexer (-snapshot), HTTP indexer (POST /import). После импорта все инструменты читают данные из Postgres.

## Хранилище

Единственная реализация Store — Postgres. При старте MCP обязателен MCP_1C_STRUCTURE_DATABASE_URL или POSTGRES_DSN. Целостность связей проверяется в сервисном слое при импорте; в БД внешние ключи не создаются.
